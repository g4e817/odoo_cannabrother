<odoo>
    <data>
        <record id="invoice_paperformat_euro" model="report.paperformat">
            <field name="name">Invoice A4</field>
            <field name="default" eval="True"/>
            <field name="format">A4</field>
            <field name="page_height">0</field>
            <field name="page_width">0</field>
            <field name="orientation">Portrait</field>
            <field name="margin_top">55</field>
            <field name="margin_bottom">35</field>
            <field name="margin_left">7</field>
            <field name="margin_right">7</field>
            <field name="header_line" eval="False"/>
            <field name="header_spacing">55</field>
            <field name="dpi">90</field>
        </record>

        <record id="custom_invoice_template.company_form" model="ir.ui.view">
            <field name="model">res.company</field>
            <field name="inherit_id" ref="base.view_company_form" />
            <field name="mode">primary</field>
            <field name="arch" type="xml">
                <field name="favicon" position="after">
                    <field name="external_report_layout_id" />
                </field>
            </field>
        </record>

        <!-- added custom paper-format in invoice report for bigger header/footer -->
        <record id='account.account_invoices' model='ir.actions.report'>
            <field name='paperformat_id' ref='invoice_paperformat_euro'/>
        </record>

        <record id='account.account_invoices_without_payment' model='ir.actions.report'>
            <field name='paperformat_id' ref='invoice_paperformat_euro'/>
        </record>

         <template id="cannabrother_layout_standard">
             <div t-attf-class="header o_company_#{company.id}_layout" t-att-style="report_header_style">
            <div class="row">
                <div class="col-3 mb4">
                    <img t-if="company.logo" t-att-src="image_data_uri(company.logo)" style="max-height: 65px; padding-top:10px;" alt="Logo"/>
                </div>
                <div class="col-9 text-right" style="margin-top:22px;" t-field="company.report_header" name="moto"/>
            </div>
            <div class="row">
                <div class="col-6" name="company_address">
                    <span t-if="company.company_details" t-field="company.company_details"></span>
                </div>
            </div>
        </div>

        <div t-attf-class="article o_report_layout_standard o_company_#{company.id}_layout {{  'o_layout_background' if company.layout_background in ['Geometric', 'Custom']  else  '' }}" t-attf-style="background-image: url({{ 'data:image/png;base64,%s' % company.layout_background_image.decode('utf-8') if company.layout_background_image and company.layout_background == 'Custom' else '/base/static/img/bg_background_template.jpg' if company.layout_background == 'Geometric' else ''}});" t-att-data-oe-model="o and o._name" t-att-data-oe-id="o and o.id" t-att-data-oe-lang="o and o.env.context.get('lang')">
            <div class="pb-4">
                <!-- This div ensures that the address is not cropped by the header. -->
                <t t-call="web.address_layout"/>
            </div>
            <t t-out="0"/>
        </div>

        <div t-attf-class="footer o_standard_footer o_company_#{company.id}_layout">
             <div class="col-12 mb4" style="border-top: 1px solid black;">
                 <div class='row'>
                     <div class='col-3 pt-4'>
                        <ul class="list-inline">
                            <li style="font-weight: 400; font-family: MercuryDisplayRoman; font-size:24px;" t-esc="company.name"/>
                        </ul>
                     </div>
                 </div>
                <div class='row'>
                    <div class='col-3'>
                        <ul class="list-inline">
                            <br/>
                            <!--<li style="font-weight: 600; font-family: MercuryDisplayRoman; font-style: italic; font-size:18px;">
                                Die
                                Natur kann es
                                GmbH
                            </li>-->
                            <li style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.street"/>
                            <li style="font-family: ChaletBook; font-weight:bold; font-size:18px;">
                                <t><span t-esc="company.city"/> <span t-esc="company.zip"></span></t>
                            </li>
                            <li itemprop="telephone"
                                style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.phone" />
                            <!--<li itemprop="email" style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.email"/>
                            <li itemprop="website"
                                style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.website"/>-->
                            <!--<li itemprop="company.name">
                            </li>-->
                            <li style="margin-top:5px">
                                <a href="#" style="margin-right:5px;color:#000;">
                                    <i class="fa fa-facebook"></i>
                                </a>
                                <a href="#" style="color:#000;">
                                    <i class="fa fa-instagram"></i>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <div class='col-3'>
                        <ul class="list-inline">
                            <br/>
                            <li/>
                            <li/>
                            <li style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.vat"/>
                            <li/>
                            <!--<li style="font-family: ChaletBook; font-weight:bold; font-size:18px;" t-esc="company.corporate_register_number"/>-->
                        </ul>
                    </div>
                    <div class='col-6'>
                        <!--<t t-set="bank_obj" t-value="company.partner_id.bank_ids.filtered(lambda bank: bank.bank_id.country == o.partner_shipping_id.country_id)">-->

                            <t t-if="'agent_id' in o.fields_get()">
                               <t t-set= "bank_obj" t-value="company.partner_id.bank_ids.filtered(lambda bank: bank.bank_id.country == o.agent_id.country_id)" />
                            </t>
                            <t t-elif="o.partner_id">
                                <t t-set= "bank_obj" t-value="company.partner_id.bank_ids.filtered(lambda bank: bank.bank_id.country == o.partner_id.country_id)" />
                            </t>
                            <t  t-elif="'partner_shipping_id' in o.fields_get()">
                                <t t-set= "bank_obj" t-value="company.partner_id.bank_ids.filtered(lambda bank: bank.bank_id.country == o.partner_shipping_id.country_id)" />
                            </t>


                            <t t-if="not bank_obj">
                                <t t-set="bank_obj" t-value="company.partner_id.bank_ids.filtered(lambda bank: bank.bank_id.country.code == 'AT')" />
                            </t>

                            <ul class="list-inline">
                                <br/>
                                <li style="font-family: ChaletBook;font-weight:bold; font-size:18px;" t-esc="bank_obj.bank_id.name"/>
                                <li style="font-family: ChaletBook;font-weight:bold; font-size:18px;">BIC: <span t-esc="bank_obj.bank_id.bic"/></li>
                                <li style="font-family: ChaletBook; font-weight:bold; font-size:18px;">IBAN: <span t-esc="bank_obj.acc_number"/></li>
                                <li/>
                            </ul>
                        <!--</t>-->
                    </div>
                    <div t-if="report_type == 'pdf'" class="col-12 text-right text-muted">
                        Seite
                        <span class="page"/>
                        von
                        <span class="topage"/>
                    </div>
                </div>
        </div>
        </div>
        </template>

        <template id="report_invoice_document" inherit_id="account.report_invoice_document">
            <xpath expr="//thead//th[@name='th_quantity']" position="replace">
            </xpath>
            <xpath expr="//tbody//tr//td[2]" position="replace">
            </xpath>
            <xpath expr="//thead//th[@name='th_description']" position="before">
                <th name="th_quantity" class="text-left"><span>Menge</span></th>
            </xpath>
            <xpath expr="//tbody//tr//td[1]" position="before">
                <td class="text-left">
                    <span t-esc="round(line.quantity)"/>
                </td>
            </xpath>
            <xpath expr="//div[@name='origin']" position="replace">
            </xpath>
            <xpath expr="//div[@name='reference']" position="replace">
            </xpath>
            <xpath expr="//p[@name='payment_communication']" position="replace">
            </xpath>
            <xpath expr="//tbody//tr//td[@name='account_invoice_line_name']" position="replace">
               <td><span t-esc="line.name[line.name.find('] ')+1:]" t-options="{'widget': 'text'}"/>
                </td>
            </xpath>

            <td t-attf-class="text-left {{ 'd-none d-md-table-cell' if report_type == 'html' else '' }}" position="replace">
                <td>
                    <span t-esc="', '.join(map(lambda x: (x.description or x.name).replace('Ust', 'Mwst').replace('USt', 'Mwst'), line.tax_ids))" id="line_tax_ids"/>
                </td>
            </td>
        </template>

         <record id="custom_invoice_template.view_picking_form" model="ir.ui.view">
            <field name="inherit_id" ref="stock.view_picking_form" />
            <field name="model">stock.picking</field>
            <field name="arch" type="xml">
                <button name="action_open_label_layout" position="attributes">
                    <attribute name="invisible">1</attribute>
                </button>
                <button name="do_print_picking" position="attributes">
                    <attribute name="invisible">1</attribute>
                </button>
                <button name="action_set_quantities_to_reservation" position="attributes">
                    <attribute name="invisible">1</attribute>
                </button>
            </field>
         </record>

    </data>
</odoo>
